{"ast":null,"code":"import _regeneratorRuntime from\"/Users/friedebold/dev/potfolio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/friedebold/dev/potfolio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import firebase from'firebase/app';import\"firebase/auth\";import'firebase/firestore';var firebaseConfig={apiKey:\"AIzaSyA7ZtxzONuN2ZbVnV5rjn1DtcEBrb7aHOM\",authDomain:\"portfolio-43d1b.firebaseapp.com\",projectId:\"portfolio-43d1b\",storageBucket:\"portfolio-43d1b.appspot.com\",messagingSenderId:\"5996957596\",appId:\"1:5996957596:web:9f2b0ad9b391c301b08259\",measurementId:\"G-WPKYEZ6B6T\"};if(!firebase.apps.length)firebase.initializeApp(firebaseConfig);else firebase.app();export default firebase;var db=firebase.firestore();var auth=firebase.auth();export var fetchInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",db.collection('data').doc('atyNgtYGT2tbctbC1FEh').get().then(function(e){return e.data();}));case 1:case\"end\":return _context.stop();}}},_callee);}));return function fetchInfo(){return _ref.apply(this,arguments);};}();export var sendEmail=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(replyTo,name,message,setEmailStatus){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(replyTo,name,message);return _context2.abrupt(\"return\",db.collection(\"mail\").add({to:\"daniel@friedebold.net\",message:{replyTo:replyTo,subject:\"Request by \".concat(name),text:message}}).then(function(){return setEmailStatus('success');}).catch(function(error){return setEmailStatus('error');}));case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function sendEmail(_x,_x2,_x3,_x4){return _ref2.apply(this,arguments);};}();//Analytics\nexport var loginUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(email,password){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:auth.signInWithEmailAndPassword(email,password).catch(function(error){var errorCode=error.code;if(errorCode==='auth/wrong-password'||errorCode==='auth/invalid-email'){console.log('credentials true');}else{console.log(errorCode);}});case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function loginUser(_x5,_x6){return _ref3.apply(this,arguments);};}();export var fetchAnalytics=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(setAnalyticsData){var query;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:query=db.collection('analytics').orderBy('timestamp','desc');query.onSnapshot(function(querySnapshot){var analyticsData=[];querySnapshot.forEach(function(doc){analyticsData.push(doc.data());});setAnalyticsData(analyticsData);},function(err){console.log(\"Encountered error: \".concat(err));});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function fetchAnalytics(_x7){return _ref4.apply(this,arguments);};}();export var stopFetchingAnalytics=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var unsub;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:unsub=db.collection('analytics').onSnapshot(function(){});unsub();case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function stopFetchingAnalytics(){return _ref5.apply(this,arguments);};}();export var addAnalytics=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(location,windowDimensions,timestamp,setFirebaseDocId){var ref;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:ref=db.collection('analytics').doc();return _context6.abrupt(\"return\",db.collection('analytics').doc(\"\".concat(ref.id)).set({location:location,dimensions:windowDimensions,timestamp:timestamp,viewed:[]}).then(function(){return setFirebaseDocId(ref.id);}).catch(function(error){return console.log('error');}));case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function addAnalytics(_x8,_x9,_x10,_x11){return _ref6.apply(this,arguments);};}();export var addContactAnalytics=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(refId,viewedPage){var timestamp;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:timestamp=new Date();return _context7.abrupt(\"return\",db.collection('analytics').doc(\"\".concat(refId)).set({viewed:/* admin. */firebase.firestore.FieldValue.arrayUnion({item:viewedPage,timestamp:timestamp})},{merge:true}).then(function(){return console.log('success');}).catch(function(error){return console.log('error');}));case 2:case\"end\":return _context7.stop();}}},_callee7);}));return function addContactAnalytics(_x12,_x13){return _ref7.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/friedebold/dev/potfolio/src/apis/firebaseApi.ts"],"names":["firebase","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","apps","length","initializeApp","app","db","firestore","auth","fetchInfo","collection","doc","get","then","e","data","sendEmail","replyTo","name","message","setEmailStatus","console","log","add","to","subject","text","catch","error","loginUser","email","password","signInWithEmailAndPassword","errorCode","code","fetchAnalytics","setAnalyticsData","query","orderBy","onSnapshot","querySnapshot","analyticsData","forEach","push","err","stopFetchingAnalytics","unsub","addAnalytics","location","windowDimensions","timestamp","setFirebaseDocId","ref","id","set","dimensions","viewed","addContactAnalytics","refId","viewedPage","Date","FieldValue","arrayUnion","item","merge"],"mappings":"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","sourcesContent":["import firebase from 'firebase/app';\nimport \"firebase/auth\";\nimport 'firebase/firestore';\nimport React, { SetStateAction } from 'react';\nimport { ClientLocation, Dimensions, PageView, Profile } from './model';\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyA7ZtxzONuN2ZbVnV5rjn1DtcEBrb7aHOM\",\n  authDomain: \"portfolio-43d1b.firebaseapp.com\",\n  projectId: \"portfolio-43d1b\",\n  storageBucket: \"portfolio-43d1b.appspot.com\",\n  messagingSenderId: \"5996957596\",\n  appId: \"1:5996957596:web:9f2b0ad9b391c301b08259\",\n  measurementId: \"G-WPKYEZ6B6T\"\n};\nif (!firebase.apps.length) firebase.initializeApp(firebaseConfig)\nelse firebase.app()\n\n\nexport default firebase\nconst db = firebase.firestore()\nconst auth = firebase.auth()\n\nexport const fetchInfo = async () => {\n  return db\n    .collection('data')\n    .doc('atyNgtYGT2tbctbC1FEh').get()\n    .then((e) => e.data() as Profile)\n}\n\n\nexport const sendEmail = async (replyTo: string, name: string, message: string, setEmailStatus: React.Dispatch<React.SetStateAction<\"non-initiated\" | \"error\" | \"success\">>\n) => {\n  console.log(replyTo, name, message)\n  return db\n    .collection(\"mail\")\n    .add({\n      to: \"daniel@friedebold.net\",\n      message: {\n        replyTo: replyTo,\n        subject: `Request by ${name}`,\n        text: message,\n      },\n    })\n    .then(() => setEmailStatus('success'))\n    .catch((error) => setEmailStatus('error'))\n}\n\n//Analytics\n\nexport const loginUser = async (email: string, password: string) => {\n  auth\n    .signInWithEmailAndPassword(email, password).catch((error) => {\n      var errorCode = error.code;\n\n      if (errorCode === 'auth/wrong-password' || errorCode === 'auth/invalid-email') {\n        console.log('credentials true')\n      } else {\n        console.log(errorCode)\n      }\n    });\n}\n\nexport const fetchAnalytics = async (setAnalyticsData: React.Dispatch<React.SetStateAction<PageView[]>>) => {\n  const query = db.collection('analytics').orderBy('timestamp', 'desc')\n  query.onSnapshot(querySnapshot => {\n    const analyticsData: PageView[] = []\n    querySnapshot.forEach(doc => {\n      analyticsData.push(doc.data() as PageView)\n    })\n    setAnalyticsData(analyticsData)\n  }\n    , err => {\n      console.log(`Encountered error: ${err}`);\n    });\n};\n\nexport const stopFetchingAnalytics = async () => {\n  const unsub = db.collection('analytics').onSnapshot(() => { })\n  unsub()\n}\n\nexport const addAnalytics = async (location: ClientLocation, windowDimensions: Dimensions, timestamp: Date, setFirebaseDocId: React.Dispatch<SetStateAction<string>>) => {\n  const ref = db.collection('analytics').doc()\n  return db\n    .collection('analytics')\n    .doc(`${ref.id}`)\n    .set({\n      location: location,\n      dimensions: windowDimensions,\n      timestamp: timestamp,\n      viewed: []\n    })\n    .then(() => setFirebaseDocId(ref.id))\n    .catch((error) => console.log('error'))\n}\n\nexport const addContactAnalytics = async (refId: string, viewedPage: string) => {\n  const timestamp = new Date()\n  return db\n    .collection('analytics')\n    .doc(`${refId}`)\n    .set({\n      viewed: /* admin. */firebase.firestore.FieldValue.arrayUnion({ item: viewedPage, timestamp: timestamp })\n    }, { merge: true })\n    .then(() => console.log('success'))\n    .catch((error) => console.log('error'))\n}"]},"metadata":{},"sourceType":"module"}